---
import CenteredLayout from "src/layouts/CenteredLayout.astro";
import { BusinessDashboard } from "src/components/react/BusinessDashboard";
import { actions } from "astro:actions";
import ErrorMessage from "components/astro/error-message.astro";
import "leaflet/dist/leaflet.css";
import { extractUUID } from "src/browser/browser";
export const prerender = false;
// const x = actions.location.getLocationsByBrandId("123");
const url = Astro.url;
const brandId = extractUUID(url, "brand");
// const brandId = url.searchParams.get("brand");
if (!brandId) {
  console.log("brand id not found in ", Astro.url);
  return new Response("123", { status: 400 });
  // return Astro.rewrite("/404");
}
const { data: locations, error } = await Astro.callAction(
  actions.location.getLocationsByBrandId,
  brandId
);
---

<CenteredLayout>
  {
    locations && (
      <BusinessDashboard
        locations={locations}
        brandId={brandId}
        client:only="react"
      />
    )
  }
  {error && <ErrorMessage errors={[error]} />}
</CenteredLayout>
